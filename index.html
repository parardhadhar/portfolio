<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parardha Dhar | ML Developer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #e5e5e5;
            overflow-x: hidden;
            cursor: none;
        }
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .section-card {
            background-color: rgba(26, 26, 26, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        .skill-tag {
            background-color: rgba(63, 63, 70, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a4a4a;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 1.5rem;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        .spinner {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 6px solid #4a4a4a;
            border-top-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        #loading-fact {
            color: #a0a0a0;
            max-width: 300px;
            text-align: center;
            font-style: italic;
            transition: opacity 0.3s ease-in-out;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        /* Custom Cursor */
        .cursor-dot, .cursor-outline {
            pointer-events: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            z-index: 9999;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        .cursor-dot {
            width: 8px;
            height: 8px;
            background-color: #3b82f6;
        }
        .cursor-outline {
            width: 40px;
            height: 40px;
            background-color: rgba(59, 130, 246, 0.2);
            border: 1px solid #3b82f6;
            transition: all 0.08s ease-out;
        }
        .cursor-hidden {
            opacity: 0;
        }
        .cursor-outline.hovered {
            transform: translate(-50%, -50%) scale(1.4);
            background-color: rgba(59, 130, 246, 0.3);
        }

        /* Click Wave Animation */
        #click-wave {
            position: fixed;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.4) 0%, rgba(59, 130, 246, 0) 60%);
            transform: translate(-50%, -50%) scale(0);
            pointer-events: none;
            z-index: 9998;
        }
        #click-wave.animate {
            animation: wave-expand 1.5s ease-out forwards;
        }
        @keyframes wave-expand {
            from {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            to {
                transform: translate(-50%, -50%) scale(30);
                opacity: 0;
            }
        }

        /* Scroll Animations */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Gemini Modal */
        #gemini-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        #gemini-modal.visible {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background-color: #1a1a1a;
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 90%;
            width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        #gemini-modal.visible .modal-content {
            transform: scale(1);
        }

        /* Generating Button Animation */
        .generating {
            animation: pulse-bg 2s infinite;
        }
        @keyframes pulse-bg {
            0% { background-color: #374151; } /* gray-700 */
            50% { background-color: #2563eb; } /* blue-600 */
            100% { background-color: #374151; } /* gray-700 */
        }
    </style>
</head>
<body class="w-full">
    <!-- Custom Cursor -->
    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>
    <div id="click-wave"></div>

    <!-- Loader -->
    <div id="loader">
        <div class="spinner"></div>
        <p id="loading-fact"></p>
        <div class="w-full max-w-xs bg-gray-800/50 rounded-full h-2.5 mt-4 border border-gray-700">
            <div id="progress-bar" class="bg-gradient-to-r from-blue-500 to-purple-500 h-2.5 rounded-full" style="width: 0%; transition: width 7s ease-out;"></div>
        </div>
    </div>

    <!-- Gemini Modal -->
    <div id="gemini-modal">
        <div class="modal-content">
            <h3 id="modal-title" class="text-2xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-purple-500">AI Generated Details</h3>
            <div id="modal-body" class="text-gray-300 space-y-4">
                <!-- AI content will be injected here -->
            </div>
            <button id="close-modal" class="mt-6 w-full py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors">Close</button>
        </div>
    </div>

    <!-- 3D Background -->
    <canvas id="bg-canvas"></canvas>
    
    <!-- Main Content -->
    <div class="relative w-full z-10 px-6 md:px-12">
        <main class="container mx-auto max-w-5xl">
            
            <!-- Hero Section -->
            <section id="hero" class="min-h-screen flex flex-col md:flex-row items-center justify-center text-center md:text-left gap-12">
                <div class="md:w-3/5">
                    <h1 class="text-5xl md:text-7xl lg:text-8xl font-black tracking-tighter leading-tight">
                        <span class="bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-purple-500">Parardha Dhar</span>
                    </h1>
                    <p class="mt-4 text-xl md:text-2xl text-gray-300 max-w-3xl">
                        Computer Science Undergrad & Machine Learning Developer crafting innovative solutions with a passion for technology and structured problem-solving.
                    </p>
                    <div class="mt-8 flex flex-wrap gap-4 justify-center md:justify-start">
                        <a href="mailto:parardhadhar@gmail.com" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors">Contact Me</a>
                        <a href="https://drive.google.com/uc?export=download&id=1G-R_Yheax-pgwup9NtWWF0QIrH2OGVQb" target="_blank" class="px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-semibold transition-colors">Download CV</a>
                        <a href="#projects" class="px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg font-semibold transition-colors">View My Work</a>
                    </div>
                </div>
                <div class="md:w-2/5 flex justify-center">
                    <img src="https://iili.io/KGrsJNp.jpg" alt="Parardha Dhar" class="w-64 h-64 md:w-80 md:h-80 rounded-full object-cover border-4 border-blue-500 shadow-lg shadow-blue-500/20">
                </div>
            </section>

            <!-- About Section -->
            <section id="about" class="py-24 reveal">
                <div class="section-card p-8 rounded-2xl">
                    <h2 class="text-3xl font-bold mb-4">About Me</h2>
                    <p class="text-gray-300 leading-relaxed space-y-4">
                        <span>As a Computer Science undergraduate at VIT Bhopal University, I am deeply immersed in the world of technology, with a strong focus on machine learning and software development. My academic journey is complemented by a hands-on approach to problem-solving, where I enjoy building robust applications and exploring complex algorithms.</span>
                        <span>I am proficient in languages like Python, Java, and C++, which I regularly use for competitive coding challenges to sharpen my logical reasoning and efficiency. My expertise extends to leveraging powerful ML frameworks like TensorFlow and PyTorch to build intelligent systems. I am dedicated to not just writing code, but architecting elegant solutions that are both scalable and impactful, continuously seeking to push the boundaries of what's possible with technology.</span>
                    </p>
                </div>
            </section>

            <!-- Projects Section -->
            <section id="projects" class="py-24">
                <h2 class="text-4xl font-bold text-center mb-12 reveal">Projects</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Project 1 -->
                    <div class="section-card p-6 rounded-2xl reveal flex flex-col h-full">
                        <h3 class="text-xl font-bold mb-2">PhishGuard: Real-Time Phishing Link Detector</h3>
                        <p class="text-gray-400 flex-grow">Engineered a real-time URL detection browser extension during a 48-hour hackathon, integrating a scikit-learn model and a phishing API to achieve 92% accuracy.</p>
                        <button class="generate-details-btn mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-semibold transition-colors w-full">✨ Ask AI for Details</button>
                    </div>
                    <!-- Project 2 -->
                    <div class="section-card p-6 rounded-2xl reveal flex flex-col h-full">
                        <h3 class="text-xl font-bold mb-2">Sentinel Verse: WebGL and AI-Driven Cybersecurity Simulation</h3>
                        <p class="text-gray-400 flex-grow">Constructed a browser-based simulation with 80+ cyber threat scenarios using Unity WebGL, featuring a decision-tree AI to evaluate threats and boost user engagement.</p>
                         <button class="generate-details-btn mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-semibold transition-colors w-full">✨ Ask AI for Details</button>
                    </div>
                    <!-- Project 3 -->
                    <div class="section-card p-6 rounded-2xl reveal flex flex-col h-full">
                        <h3 class="text-xl font-bold mb-2">Music Mood Matcher: Emotion-Based Music Recommender</h3>
                        <p class="text-gray-400 flex-grow">Designed a web app integrating face-api.js to analyze facial expressions and link with the Spotify API for dynamic, mood-based playlist generation.</p>
                         <button class="generate-details-btn mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-semibold transition-colors w-full">✨ Ask AI for Details</button>
                    </div>
                    <!-- Project 4 -->
                    <div class="section-card p-6 rounded-2xl reveal flex flex-col h-full">
                        <h3 class="text-xl font-bold mb-2">AI Handwriting Generator: Flask-Based Web App</h3>
                        <p class="text-gray-400 flex-grow">Developed a Python and Flask tool to transform text and PDF inputs into realistic, notebook-style handwritten PDFs with precise font rendering.</p>
                         <button class="generate-details-btn mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-semibold transition-colors w-full">✨ Ask AI for Details</button>
                    </div>
                </div>
            </section>

            <!-- Experience Section -->
            <section id="experience" class="py-24">
                <h2 class="text-4xl font-bold text-center mb-12 reveal">Experience</h2>
                <div class="space-y-8 relative">
                    <div class="absolute left-3 top-3 bottom-3 w-0.5 bg-gray-700"></div>
                    <!-- Experience Item 1 -->
                    <div class="pl-10 relative reveal">
                        <div class="absolute -left-0.5 top-2 w-3 h-3 bg-blue-500 rounded-full"></div>
                        <h3 class="text-xl font-bold">Electronic Arts - Software Engineering Virtual Experience</h3>
                        <p class="text-gray-400 italic">Forage, May 2025</p>
                        <p class="mt-2 text-gray-300">Formulated a feature proposal for EA Sports, designed a C++ class diagram for weather effects, and optimized code by implementing an advanced data structure, achieving a 15% performance increase.</p>
                    </div>
                    <!-- Experience Item 2 -->
                    <div class="pl-10 relative reveal">
                         <div class="absolute -left-0.5 top-2 w-3 h-3 bg-blue-500 rounded-full"></div>
                        <h3 class="text-xl font-bold">Open-Source Contributor</h3>
                        <p class="text-gray-400 italic">2024-Present</p>
                        <p class="mt-2 text-gray-300">Collaborated with global developers, submitting pull requests and issues to enhance machine learning and game development repositories. Refined decision engines using Python and JSON.</p>
                    </div>
                    <!-- Experience Item 3 -->
                    <div class="pl-10 relative reveal">
                         <div class="absolute -left-0.5 top-2 w-3 h-3 bg-blue-500 rounded-full"></div>
                        <h3 class="text-xl font-bold">AI and Web Development Research Lead</h3>
                        <p class="text-gray-400 italic">2024-Present</p>
                        <p class="mt-2 text-gray-300">Directed AI-based farmer application research using scikit-learn. Investigated fake news detection with an NLP-based model, achieving 90% preliminary accuracy.</p>
                    </div>
                </div>
            </section>
            
            <!-- Education Section -->
            <section id="education" class="py-24">
                <h2 class="text-4xl font-bold text-center mb-12 reveal">Education</h2>
                <div class="space-y-8">
                    <div class="section-card p-6 rounded-2xl reveal">
                        <h3 class="text-xl font-bold">VIT Bhopal University</h3>
                        <p class="text-gray-400">Bachelor of Technology in Computer Science Engineering (2024-2028)</p>
                    </div>
                     <div class="section-card p-6 rounded-2xl reveal">
                        <h3 class="text-xl font-bold">Darjeeling Public School Siliguri</h3>
                        <p class="text-gray-400">12th Grade - CBSE (2022-2024)</p>
                    </div>
                    <div class="section-card p-6 rounded-2xl reveal">
                        <h3 class="text-xl font-bold">Don Bosco School Siliguri</h3>
                        <p class="text-gray-400">10th Grade - ICSE (2012-2022)</p>
                    </div>
                </div>
            </section>
            
            <!-- Certifications Section -->
            <section id="certifications" class="py-24">
                <h2 class="text-4xl font-bold text-center mb-12 reveal">Certifications</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="section-card p-6 rounded-2xl reveal"><p>Supervised Machine Learning: Regression and Classification - DeepLearning.ai</p></div>
                    <div class="section-card p-6 rounded-2xl reveal"><p>Introduction to Security Principles in Cloud Computing - Google Cloud</p></div>
                    <div class="section-card p-6 rounded-2xl reveal"><p>AI/ML For Geo Data Analysis</p></div>
                    <div class="section-card p-6 rounded-2xl reveal"><p>Electronic Arts - Software Engineering Job Simulation</p></div>
                </div>
            </section>

            <!-- Skills Section -->
            <section id="skills" class="py-24">
                <h2 class="text-4xl font-bold text-center mb-12 reveal">Technical Skills</h2>
                <div class="flex flex-wrap justify-center gap-4 reveal">
                    <span class="skill-tag px-4 py-2 rounded-lg">Python</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">Java</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">C++</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">Competitive Coding</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">TensorFlow</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">PyTorch</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">Scikit-learn</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">HTML</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">CSS</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">JavaScript</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">Unreal Engine</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">Unity (WebGL)</span>
                    <span class="skill-tag px-4 py-2 rounded-lg">GitHub</span>
                </div>
            </section>

             <!-- AI Career Advisor Section -->
            <section id="ai-advisor" class="py-24">
                <h2 class="text-4xl font-bold text-center mb-12 reveal">✨ Ask My Ai twiner.</h2>
                <div class="section-card p-8 rounded-2xl reveal">
                    <p class="text-center text-gray-300 mb-6">Have a question about my skills or potential career paths? Ask my AI assistant!</p>
                    <div class="flex flex-col md:flex-row gap-4">
                        <input id="advisor-input" type="text" placeholder="e.g., 'What roles suit Parardha's profile?'" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button id="advisor-submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors">Ask AI</button>
                    </div>
                    <div id="advisor-response-container" class="mt-6 p-4 bg-gray-900/50 border border-gray-700 rounded-lg" style="display: none;">
                        <p id="advisor-response" class="text-gray-300 whitespace-pre-wrap"></p>
                    </div>
                </div>
            </section>
            
            <!-- Footer/Contact Section -->
            <footer class="text-center py-12 reveal">
                <p class="text-lg mb-4">Let's connect.</p>
                <div class="flex justify-center gap-6 mb-8">
                     <a href="mailto:parardhadhar@gmail.com" class="text-gray-400 hover:text-blue-500 transition-colors text-2xl">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-blue-500 transition-colors text-2xl" aria-label="LinkedIn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-blue-500 transition-colors text-2xl" aria-label="GitHub">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
                    </a>
                </div>
                <p class="text-gray-500">&copy; 2025 Parardha Dhar. All rights reserved.</p>
            </footer>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Loading Screen Logic ---
            const facts = [
                "Highlight: PhishGuard detects phishing links with 92% accuracy.",
                "Highlight: Sentinel Verse is a cybersecurity game with over 80 unique scenarios.",
                "Highlight: Music Mood Matcher uses facial recognition to create playlists.",
                "Highlight: I built an AI that can generate realistic handwriting from text.",
                "Credentialed: Certified in Supervised Machine Learning by DeepLearning.ai.",
                "Multi-lingual: Fluent in Python, Java, C++, and human languages like Bengali!"
            ];
            const loadingFactEl = document.getElementById('loading-fact');
            let factInterval;

            function showRandomFact() {
                const randomIndex = Math.floor(Math.random() * facts.length);
                loadingFactEl.style.opacity = 0;
                setTimeout(() => {
                    loadingFactEl.textContent = facts[randomIndex];
                    loadingFactEl.style.opacity = 1;
                }, 300);
            }
            showRandomFact(); // Show first fact immediately
            factInterval = setInterval(showRandomFact, 1800);

            const progressBar = document.getElementById('progress-bar');
            const pageLoader = document.getElementById('loader');

            // Start the progress bar animation
            setTimeout(() => {
                progressBar.style.width = '100%';
            }, 10);

            // Initialize the 3D scene in the background
            init();

            // Set a minimum 7-second timer to hide the loader
            setTimeout(() => {
                clearInterval(factInterval);
                pageLoader.style.opacity = '0';
                setTimeout(() => { 
                    pageLoader.style.display = 'none'; 
                }, 500); // This should match the CSS transition duration
            }, 7000);
        });


        // --- Three.js Scene Setup ---
        let scene, camera, renderer, laptopModel, particles;
        let raycaster, mouse;
        let isModelHovered = false;
        let targetScale = 1;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            const canvas = document.getElementById('bg-canvas');
            renderer = new THREE.WebGLRenderer({ 
                canvas: canvas, 
                antialias: true, 
                alpha: true,
                powerPreference: 'high-performance' 
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.outputEncoding = THREE.sRGBEncoding;

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const light1 = new THREE.DirectionalLight(0x0077ff, 2);
            light1.position.set(-5, 5, 5);
            scene.add(light1);

            const light2 = new THREE.DirectionalLight(0x8e44ad, 2);
            light2.position.set(5, -5, 5);
            scene.add(light2);

            const geometry = new THREE.IcosahedronGeometry(1.5, 0);
            const material = new THREE.MeshStandardMaterial({
                color: 0xe5e5e5,
                metalness: 0.7,
                roughness: 0.1
            });
            laptopModel = new THREE.Mesh(geometry, material);
            laptopModel.position.y = 0;
            scene.add(laptopModel);

            const particlesGeometry = new THREE.BufferGeometry();
            const particlesCount = 4000;
            const posArray = new Float32Array(particlesCount * 3);
            for(let i=0; i < particlesCount * 3; i++) {
                posArray[i] = (Math.random() - 0.5) * 20;
            }
            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            const particlesMaterial = new THREE.PointsMaterial({ size: 0.010, color: 0xffffff });
            particles = new THREE.Points(particlesGeometry, particlesMaterial);
            scene.add(particles);

            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            window.addEventListener('resize', onWindowResize, false);
            window.addEventListener('scroll', onScroll, false);
            window.addEventListener('pointermove', onPointerMove);
            window.addEventListener('click', onClickModel);
            
            animate();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function onScroll() {
            const t = document.body.getBoundingClientRect().top;
            if (laptopModel) {
                laptopModel.position.y = t * 0.002; 
                laptopModel.rotation.x = t * 0.0005;
                laptopModel.rotation.z = t * 0.00025;
            }
        }
        
        function onPointerMove(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
        }

        function onClickModel(event) {
            if (isModelHovered) {
                const wave = document.getElementById('click-wave');
                if (wave) {
                    const size = Math.max(window.innerWidth, window.innerHeight) * 0.1;
                    wave.style.width = `${size}px`;
                    wave.style.height = `${size}px`;
                    wave.style.top = `${event.clientY}px`;
                    wave.style.left = `${event.clientX}px`;
                    wave.classList.remove('animate');
                    void wave.offsetWidth;
                    wave.classList.add('animate');
                }
            }
        }

        const clock = new THREE.Clock();
        function animate() {
            requestAnimationFrame(animate);
            const elapsedTime = clock.getElapsedTime();

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObject(laptopModel);

            if (intersects.length > 0) {
                if (!isModelHovered) {
                     document.body.style.cursor = 'pointer';
                     isModelHovered = true;
                     targetScale = 1.1;
                }
            } else {
                if (isModelHovered) {
                     document.body.style.cursor = 'none';
                     isModelHovered = false;
                     targetScale = 1;
                }
            }
            
            if (laptopModel) {
                laptopModel.scale.lerp(new THREE.Vector3(targetScale, targetScale, targetScale), 0.1);
                laptopModel.rotation.y += 0.001;
            }

            particles.rotation.y = -0.01 * elapsedTime;
            renderer.render(scene, camera);
        }

        const cursorDot = document.querySelector(".cursor-dot");
        const cursorOutline = document.querySelector(".cursor-outline");

        window.addEventListener("mousemove", function (e) {
            const posX = e.clientX;
            const posY = e.clientY;
            cursorDot.style.left = `${posX}px`;
            cursorDot.style.top = `${posY}px`;
            cursorOutline.animate({
                left: `${posX}px`,
                top: `${posY}px`
            }, { duration: 500, fill: "forwards" });
        });

        document.querySelectorAll('a, button').forEach(el => {
            el.addEventListener('mouseover', () => cursorOutline.classList.add('hovered'));
            el.addEventListener('mouseleave', () => cursorOutline.classList.remove('hovered'));
        });

        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.reveal').forEach((el) => {
            observer.observe(el);
        });

        // --- Gemini API Integration ---
        const apiKey = "AIzaSyBwAyF5PPVxM7sZrwu4XxuKhSlfXv5IQaw";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
        
        const modal = document.getElementById('gemini-modal');
        const modalBody = document.getElementById('modal-body');
        const closeModalBtn = document.getElementById('close-modal');
        const generateDetailsBtns = document.querySelectorAll('.generate-details-btn');
        let activeButton = null;

        const callGeminiAPI = async (payload, maxRetries = 3) => {
            let attempt = 0;
            while (attempt < maxRetries) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const candidate = result.candidates?.[0];
                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        return candidate.content.parts[0].text;
                    } else {
                        throw new Error('Invalid response structure from API');
                    }
                } catch (error) {
                    attempt++;
                    if (attempt >= maxRetries) {
                        console.error('API call failed after multiple retries:', error);
                        if (error.message.includes("503")) {
                            return 'The AI service is temporarily unavailable. Please try again in a few moments.';
                        }
                        return 'Sorry, I was unable to get a response from the AI. Please try again later.';
                    }
                    const delay = Math.pow(2, attempt) * 1000;
                    await new Promise(res => setTimeout(res, delay));
                }
            }
        };

        const showModalWithContent = (content) => {
            modalBody.innerHTML = content.replace(/\n/g, '<br>');
            modal.classList.add('visible');
        };
        
        closeModalBtn.addEventListener('click', () => {
            modal.classList.remove('visible');
            if (activeButton) {
                activeButton.disabled = false;
                activeButton.innerText = '✨ Ask AI for Details';
                activeButton.classList.remove('generating');
                activeButton = null;
            }
            document.body.classList.remove('ai-loading');
        });

        generateDetailsBtns.forEach(btn => {
            btn.addEventListener('click', async (e) => {
                if (document.body.classList.contains('ai-loading')) return;

                document.body.classList.add('ai-loading');
                activeButton = e.target;
                activeButton.disabled = true;
                activeButton.innerText = '✨ Generating...';
                activeButton.classList.add('generating');
                
                const card = activeButton.closest('.section-card');
                const title = card.querySelector('h3').innerText;
                const description = card.querySelector('p').innerText;

                const prompt = `Based on the project title "${title}" and this short description: "${description}", please generate a more detailed and professional project summary. Elaborate on the potential technologies used, the problem it solves, and its potential impact. Use a professional and engaging tone. Structure the output in well-written paragraphs.`;
                
                const payload = { contents: [{ parts: [{ text: prompt }] }] };
                const aiResponse = await callGeminiAPI(payload);
                
                showModalWithContent(aiResponse);
            });
        });

        // --- AI Career Advisor Logic ---
        const advisorInput = document.getElementById('advisor-input');
        const advisorSubmitBtn = document.getElementById('advisor-submit');
        const advisorResponseContainer = document.getElementById('advisor-response-container');
        const advisorResponseEl = document.getElementById('advisor-response');
        
        advisorSubmitBtn.addEventListener('click', async () => {
            const userQuery = advisorInput.value.trim();
            if (!userQuery) return;

            advisorResponseContainer.style.display = 'block';
            advisorResponseEl.innerHTML = '<div class="flex justify-center items-center"><div class="spinner w-8 h-8"></div></div>';
            advisorSubmitBtn.disabled = true;
            advisorSubmitBtn.innerText = 'Thinking...';
            
            const systemPrompt = `You are a helpful and insightful AI career advisor. Your purpose is to provide guidance to visitors of Parardha Dhar's portfolio. Parardha is a Computer Science undergraduate specializing in Machine Learning. His skills include Python, TensorFlow, PyTorch, Scikit-learn, and web/game development. His projects are PhishGuard (a phishing detector), Sentinel Verse (a cybersecurity game), Music Mood Matcher (an emotion-based music recommender), and an AI Handwriting Generator.`;
            
            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            const aiResponse = await callGeminiAPI(payload);
            advisorResponseEl.innerText = aiResponse;
            advisorSubmitBtn.disabled = false;
            advisorSubmitBtn.innerText = 'Ask AI';
        });

    </script>
</body>
</html>

